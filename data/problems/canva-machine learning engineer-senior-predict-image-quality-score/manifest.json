{
  "id": "canva-machine learning engineer-senior-predict-image-quality-score",
  "title": "Predict Image Quality Score",
  "statement": "Canva allows users to upload their own images. To ensure a high-quality user experience, we need to automatically assess the quality of uploaded images and flag those below a certain threshold. Design a machine learning model that predicts an image quality score based on various image features.\n\nConsider the following image quality factors:\n\n*   **Blurriness:** How blurry is the image?\n*   **Noise:** How much noise is present in the image?\n*   **Compression Artifacts:** Are there visible compression artifacts (e.g., JPEG artifacts)?\n*   **Resolution:** Is the resolution of the image sufficient for its intended use?\n*   **Colorfulness:** Is the image vibrant and colorful or dull and washed out?\n\nInput: An image file (e.g., JPEG, PNG). You can assume you have access to libraries for image processing (e.g., OpenCV, Pillow).\nOutput: A numerical score between 0 and 1 representing the image quality (0 = very low quality, 1 = very high quality).\n\nDescribe:\n\n*   **Feature Extraction:** What image processing techniques would you use to extract relevant features from the image (e.g., using OpenCV filters, frequency domain analysis)?\n*   **Model Selection:** Which machine learning model would you choose (e.g., linear regression, random forest, neural network)? Justify your choice.\n*   **Training Data:** How would you obtain or create training data for this model? Consider both supervised and unsupervised approaches.\n*   **Evaluation Metrics:** What metrics would you use to evaluate the performance of the model (e.g., Mean Squared Error, Root Mean Squared Error, Rank Correlation)?\n\nProvide Python code snippets for feature extraction and model prediction (using a library like OpenCV and scikit-learn).\n\n**Example Input:** An image of a blurry cat.\n**Example Output:** 0.3\n",
  "languages": [
    "python",
    "java",
    "cpp"
  ],
  "stub": {
    "cpp": "// Requires OpenCV C++ bindings\n#include \u003copencv2/opencv.hpp\u003e\n\nclass Solution {\npublic:\n    double predictImageQuality(const std::string\u0026 imagePath) {\n        // Load the image using OpenCV\n        cv::Mat image = cv::imread(imagePath, cv::IMREAD_COLOR);\n\n        // Check if the image was loaded successfully\n        if (image.empty()) {\n            std::cerr \u003c\u003c \"Could not open or find the image!\" \u003c\u003c std::endl;\n            return 0.0; // Or throw an exception\n        }\n\n        // Feature extraction (example: blur detection using variance of Laplacian)\n        cv::Mat grayImage;\n        cv::cvtColor(image, grayImage, cv::COLOR_BGR2GRAY);\n        cv::Mat laplacian;\n        cv::Laplacian(grayImage, laplacian, CV_64F);\n        cv::Scalar mean, stddev;\n        cv::meanStdDev(laplacian, mean, stddev);\n        double blurScore = stddev[0] * stddev[0];  // Variance\n\n\n        // Add more features here (noise, compression artifacts, etc.)...\n\n        // Model prediction (This is where you'd load your trained model and make a prediction)\n        // For demonstration, a simple calculation based on blurScore\n        double qualityScore = 1.0 - (blurScore / 1000.0); // Example scaling\n        qualityScore = std::max(0.0, std::min(1.0, qualityScore)); // Clamp to [0, 1]\n\n\n        return qualityScore;\n    }\n};\n",
    "java": "// Requires OpenCV Java bindings\n// Implementation outline only.  More complete processing and ML steps needed.\nclass Solution {\n    public double predictImageQuality(String imagePath) {\n        // Load the image using OpenCV's Mat class\n        // ...\n\n        // Feature extraction (example: blur detection)\n        // ...\n\n        // Model prediction (replace with your trained model)\n        // ...\n\n        // Return a dummy score\n        return 0.5;\n    }\n}",
    "python": "import cv2\nimport numpy as np\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.ensemble import RandomForestRegressor\n\ndef predict_image_quality(image_path):\n    \"\"\"Predicts the image quality score.\"\"\"\n    # Load the image\n    img = cv2.imread(image_path)\n\n    # Feature extraction (example: compute variance of Laplacian for blur detection)\n    gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)\n    blur_score = cv2.Laplacian(gray, cv2.CV_64F).var()\n\n    # Add more features here...\n\n    # Model prediction (replace with your trained model)\n    # Assuming you have a pre-trained model named 'model'\n    # And feature scaling applied previously.  Illustrative only.\n    # quality_score = model.predict([[blur_score, ...]])[0]\n\n    # For demonstration purposes, return a dummy score based on blur_score\n    quality_score = max(0, min(1, 1 - (blur_score / 1000)))  # Scale and clip to [0, 1]\n\n    return quality_score\n\n\n# Example Usage (illustrative only, training and model loading omitted)\n# image_quality = predict_image_quality(\"path/to/your/image.jpg\")\n# print(f\"Image Quality: {image_quality}\")\n\n\n"
  }
}