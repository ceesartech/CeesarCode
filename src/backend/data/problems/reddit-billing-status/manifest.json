{
  "ID": "reddit-billing-status",
  "Title": "Reddit Billing Status",
  "Statement": "We accidentally dropped the database where we store the current billing status for our advertisers. Fortunately, we still have the logs for all the transactions they did, and we can use this to recreate the dropped data.\n\nPart 1\n\nYou are asked to process the financial transactions from the old system to build up a BillingStatus per user to be stored in our new system. You should create a class called BillingStatus, which will represent an account state. Each financial transaction represents a modification to a BillingStatus. A BillingStatus should be able to ingest new transactions that are generated in our own systems.\n\nGiven a collection of financial transactions, we want to generate a BillingStatus instance for each user. This can be represented as a dict:\n```\n    { user_id: BillingStatus(), user_id2: BillingStatus()}\n```\n\nOur BillingStatus class should start with two monetary columns:\n```\n    'ad_delivery_pennies': 0, 'payment_pennies': 0\n```\n\nEach transaction can have multiple monetary columns. Upon processing a transaction, the values in the monetary columns should be added to the current value in the BillingStatus.\n\nGiven this input:\n```\nmonetary_columns = ('ad_delivery_pennies','payment_pennies')\ntransactions = {\n    'ff8bc1c2-8d45-11e9-bc42-526af7764f64': {'user_id': 1, 'ad_delivery_pennies': 1000, 'transaction_timestamp': 1500000001},\n    'ff8bc2e4-8d45-11e9-bc42-526af7764f64': {'user_id': 1, 'ad_delivery_pennies': 1000, 'transaction_timestamp': 1500000002},\n    'ff8bc4ec-8d45-11e9-bc42-526af7764f64': {'user_id': 1, 'payment_pennies': 500, 'transaction_timestamp': 1500000003},\n    'fv24z4ec-8d45-11e9-bc42-526af7764f64': {'user_id': 1, 'ad_delivery_pennies': 1000, 'payment_pennies': 500, 'transaction_timestamp': 1500000004}\n}\n```\n\nExpected Output (format however you want):\n```\n{1: BillingStatus(‘ad_delivery_pennies’=3000, ‘payment_pennies’=1000)}\n```",
  "Languages": [
    "python",
    "java",
    "go"
  ],
  "Stub": {
    "python": ""
  },
  "Type": "coding",
  "IsMultiPart": true,
  "Parts": [
    {
      "partNumber": 2,
      "statement": "Part 2\n\nNow let's add a concept of an \"overwrite transaction\" where the transaction can indicate whether it should overwrite the current BillingStatus monetary value with the monetary value in the transaction.\n\n```\nmonetary_columns = ('ad_delivery_pennies','payment_pennies')\ntransactions = {\n    'ff8ba98a-8d45-11e9-bc42-526af7764f64': {'user_id': 1, 'ad_delivery_pennies': 1000, 'transaction_timestamp': 1500000001,'overwrite': False},\n    'ff8bad4a-8d45-11e9-bc42-526af7764f64': {'user_id': 2, 'ad_delivery_pennies': 1000, 'transaction_timestamp': 1500000004},\n    'ff8baea8-8d45-11e9-bc42-526af7764f64': {'user_id': 2, 'payment_pennies': 600, 'transaction_timestamp': 1500000007,'overwrite': False},\n    'ff8bb4ac-8d45-11e9-bc42-526af7764f64': {'user_id': 1, 'ad_delivery_pennies': 1000, 'transaction_timestamp': 1500000002,'overwrite': False},\n    'ff8bb600-8d45-11e9-bc42-526af7764f64': {'user_id': 2, 'ad_delivery_pennies': 1000, 'payment_pennies': 500, 'transaction_timestamp': 1500000003,'overwrite': False},\n    'ff8bb89e-8d45-11e9-bc42-526af7764f64': {'user_id': 2, 'payment_pennies': 2000, 'transaction_timestamp': 1500000005,'overwrite': True},\n    'ff8bb9c0-8d45-11e9-bc42-526af7764f64': {'user_id': 1, 'payment_pennies': 500, 'transaction_timestamp': 1500000003, 'overwrite': False},\n    'ff8bbf74-8d45-11e9-bc42-526af7764f64': {'user_id': 1, 'ad_delivery_pennies': 1000, 'payment_pennies': 500, 'transaction_timestamp': 1500000004, 'overwrite': True},\n    'ff8bc0a0-8d45-11e9-bc42-526af7764f64': {'user_id': 2, 'ad_delivery_pennies': 1000, 'transaction_timestamp': 1500000001},\n    'ff8bc1c2-8d45-11e9-bc42-526af7764f64': {'user_id': 2, 'ad_delivery_pennies': 1000, 'transaction_timestamp': 1500000002},\n    'ff923488-8d45-11e9-bc42-526af7764f64': {'user_id': 1, 'payment_pennies': 100, 'transaction_timestamp': 1500000013},\n}\n\noutput = {\n  1: BillingStatus('ad_delivery_pennies'=1000, 'payment_pennies'=600),\n  2: BillingStatus('ad_delivery_pennies'=4000, 'payment_pennies'=2600),\n}\n```",
      "stub": {}
    },
    {
      "partNumber": 3,
      "statement": "Now we want to add an additional concept of 'undo_last' and 'redo_last'. When 'undo_last' is set to True, it will undo a regular transaction before it, where regular transaction is one of: a transaction without any options ('overwrite', 'undo_last' or 'redo_last') or a transaction with only 'overwrite'. When 'redo_last' is set to True, it will redo a previously undone transaction, if non transactions were reverted then this operation can discarded.\n\n```\nmonetary_columns = ('ad_delivery_pennies','payment_pennies')\ntransactions = {\n    'ff8bc1c2-8d45-11e9-bc42-526af7764f64': {'user_id': 1, 'ad_delivery_pennies': 1000, 'transaction_timestamp': 1500000001},\n    'ff8bc2e4-8d45-11e9-bc42-526af7764f64': {'user_id': 1, 'undo_last': True, 'transaction_timestamp': 1500000002},\n    'ff8bc4ec-8d45-11e9-bc42-526af7764f64': {'user_id': 1, 'payment_pennies': 500, 'transaction_timestamp': 1500000003},\n    'fv24z4ec-8d45-11e9-bc42-526af7764f64': {'user_id': 1, 'ad_delivery_pennies': 1000, 'payment_pennies': 500, 'transaction_timestamp': 1500000004}\n}\n\noutput = {\n  1: BillingStatus('ad_delivery_pennies'=1000, 'payment_pennies'=1000),\n}\n```\n\n[execution time limit] 4 seconds (py3) [memory limit] 1 GB",
      "stub": {}
    }
  ]
}