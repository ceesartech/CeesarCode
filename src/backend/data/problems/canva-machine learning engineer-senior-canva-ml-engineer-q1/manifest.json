{
  "id": "canva-machine learning engineer-senior-canva-ml-engineer-q1",
  "title": "Scalable Collaborative Filtering for Template Recommendations",
  "statement": "Canva wants to improve its template recommendation system using collaborative filtering.  We have a large dataset of user interactions (clicks) with different templates. The dataset is too large to fit in memory. Design a scalable solution to predict the probability a user will click on a specific template, given their past interactions and the interactions of other users. Explain your choice of algorithms, data structures, and how you would handle cold start problems (new users or new templates). Specifically, how would you implement a MapReduce or Spark job to calculate user-template similarity, and how would you serve these recommendations in real-time with low latency.  Assume you have access to user ID, template ID, and timestamp of click events. \n\nExample Input:  A stream of (user_id, template_id, timestamp) tuples.  (123, 456, 1678886400), (123, 789, 1678886460), (456, 456, 1678886500), (789, 123, 1678886560), ...\n\nExpected Output: A system that, given a user_id, returns a ranked list of template_ids with associated click probability scores. E.g., for user_id 123: [(456, 0.85), (1011, 0.72), (1314, 0.65), ...]",
  "languages": [
    "python",
    "java",
    "cpp"
  ],
  "stub": {
    "cpp": "class Solution {\npublic:\n    std::vector\u003cstd::pair\u003cint, double\u003e\u003e recommendTemplates(int userId) {\n        // Your code here\n    }\n};",
    "java": "class Solution {\n    public List\u003cPair\u003cInteger, Double\u003e\u003e recommendTemplates(int userId) {\n        // Your code here\n    }\n}",
    "python": "def recommend_templates(user_id):\n    # Your code here\n    pass"
  }
}