{
  "ID": "reddit-software engineer-senior-session-token-validation",
  "Title": "Session Token Validation and Revocation",
  "Statement": "Implement a `SessionManager` class to handle user session tokens. This manager should provide methods for issuing, validating, and revoking tokens efficiently.\n1.  `create_session(user_id: str, expiration_seconds: int) -\u003e str`: Generates a unique session token for `user_id` that expires after `expiration_seconds`. Returns the token string.\n2.  `validate_session(token: str) -\u003e str | None`: Checks if the token is valid (exists, not expired, not revoked). Returns the `user_id` if valid, otherwise `None`.\n3.  `revoke_session(token: str)`: Invalidates a given token immediately, even if it hasn't expired.\n\nTokens do not need to be cryptographically secure for this problem (e.g., UUIDs are sufficient). Focus on the in-memory data structures and logic for fast lookups and efficient expiration/revocation.\n\nExample:\n`manager = SessionManager()`\n`token1 = manager.create_session('user_A', 3600)`\n`manager.validate_session(token1)` -\u003e `'user_A'`\n`manager.revoke_session(token1)`\n`manager.validate_session(token1)` -\u003e `None`\n`token2 = manager.create_session('user_B', 1)`\n(Wait 2 seconds)\n`manager.validate_session(token2)` -\u003e `None`\n\nConstraints:\n- Number of active sessions can be up to 100,000.\n- `expiration_seconds` up to 1 day (86400 seconds).\n- Token strings can be UUID-like, e.g., 36 characters long.",
  "Languages": [
    "python",
    "java",
    "cpp",
    "javascript",
    "go",
    "rust"
  ],
  "Stub": {
    "cpp": "#include \u003cstring\u003e\n#include \u003cunordered_map\u003e\n#include \u003cchrono\u003e\n#include \u003cmutex\u003e\n#include \u003crandom\u003e\n#include \u003calgorithm\u003e\n\n// Basic UUID generation for illustration\nstd::string generate_uuid() {\n    static std::random_device rd;\n    static std::mt19937 gen(rd());\n    static std::uniform_int_distribution\u003c\u003e dis(0, 15);\n    static std::uniform_int_distribution\u003c\u003e dis2(8, 11);\n\n    std::string uuid_str;\n    uuid_str.reserve(36);\n    for (int i = 0; i \u003c 36; ++i) {\n        if (i == 8 || i == 13 || i == 18 || i == 23) {\n            uuid_str += '-';\n        } else {\n            int r = dis(gen);\n            if (i == 14) {\n                uuid_str += '4';\n            } else if (i == 19) {\n                uuid_str += \"0123456789abcdef\"[dis2(gen)];\n            } else {\n                uuid_str += \"0123456789abcdef\"[r];\n            }\n        }\n    }\n    return uuid_str;\n}\n\nclass SessionManager {\npublic:\n    SessionManager() {\n        // Your code here\n    }\n\n    std::string createSession(const std::string\u0026 userId, int expirationSeconds) {\n        // Your code here\n        return \"\";\n    }\n\n    std::string validateSession(const std::string\u0026 token) {\n        // Your code here\n        return \"\"; // Or return std::nullopt\u003cstd::string\u003e() for C++17\n    }\n\n    void revokeSession(const std::string\u0026 token) {\n        // Your code here\n    }\n};\n",
    "go": "package main\n\nimport (\n\t\"time\"\n\t\"github.com/google/uuid\"\n\t\"sync\"\n)\n\ntype SessionManager struct {\n\t// Your code here\n}\n\nfunc NewSessionManager() *SessionManager {\n\treturn \u0026SessionManager{\n\t\t// Your code here\n\t}\n}\n\nfunc (sm *SessionManager) CreateSession(userId string, expirationSeconds int) string {\n\t// Your code here\n\treturn \"\"\n}\n\nfunc (sm *SessionManager) ValidateSession(token string) string {\n\t// Your code here\n\treturn \"\"\n}\n\nfunc (sm *SessionManager) RevokeSession(token string) {\n\t// Your code here\n}\n",
    "java": "import java.util.concurrent.ConcurrentHashMap;\nimport java.util.UUID;\nimport java.util.concurrent.TimeUnit;\n\nclass SessionManager {\n    public SessionManager() {\n        // Your code here\n    }\n\n    public String createSession(String userId, int expirationSeconds) {\n        // Your code here\n        return \"\";\n    }\n\n    public String validateSession(String token) {\n        // Your code here\n        return null;\n    }\n\n    public void revokeSession(String token) {\n        // Your code here\n    }\n}",
    "javascript": "class SessionManager {\n    constructor() {\n        // Your code here\n    }\n\n    _generateUUID() {\n        return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n            var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r \u0026 0x3 | 0x8);\n            return v.toString(16);\n        });\n    }\n\n    createSession(userId, expirationSeconds) {\n        // Your code here\n        return \"\";\n    }\n\n    validateSession(token) {\n        // Your code here\n        return null;\n    }\n\n    revokeSession(token) {\n        // Your code here\n    }\n}",
    "python": "import time\nimport uuid\n\nclass SessionManager:\n    def __init__(self):\n        # Your code here\n        pass\n\n    def create_session(self, user_id: str, expiration_seconds: int) -\u003e str:\n        # Your code here\n        return \"\"\n\n    def validate_session(self, token: str) -\u003e str | None:\n        # Your code here\n        return None\n\n    def revoke_session(self, token: str):\n        # Your code here\n        pass",
    "rust": "use std::collections::HashMap;\nuse std::time::{Instant, Duration};\nuse uuid::Uuid;\nuse std::sync::{Arc, Mutex};\n\npub struct SessionManager {\n    // Your code here\n}\n\nimpl SessionManager {\n    pub fn new() -\u003e Self {\n        SessionManager {\n            // Your code here\n        }\n    }\n\n    pub fn create_session(\u0026mut self, user_id: String, expiration_seconds: u64) -\u003e String {\n        // Your code here\n        \"\".to_string()\n    }\n\n    pub fn validate_session(\u0026self, token: String) -\u003e Option\u003cString\u003e {\n        // Your code here\n        None\n    }\n\n    pub fn revoke_session(\u0026mut self, token: String) {\n        // Your code here\n    }\n}"
  },
  "Type": "coding"
}